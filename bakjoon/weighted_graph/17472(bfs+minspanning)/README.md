# 문제: 17472(다리만들기 2)

섬으로 이루어진 나라가 있고, 모든 섬을 다리로 연결하려고 한다. 이 나라의 지도는 N×M 크기의 이차원 격자로 나타낼 수 있고, 격자의 각 칸은 땅이거나 바다이다.

섬은 연결된 땅이 상하좌우로 붙어있는 덩어리를 말한다.

다리는 바다에만 건설할 수 있고, 다리의 길이는 다리가 격자에서 차지하는 칸의 수이다. 다리를 연결해서 모든 섬을 연결하려고 한다. 섬 A에서 다리를 통해 섬 B로 갈 수 있을 때, 섬 A와 B를 연결되었다고 한다. 다리의 양 끝은 섬과 인접한 바다 위에 있어야 하고, 한 다리의 방향이 중간에 바뀌면 안된다. 또, 다리의 길이는 2 이상이어야 한다.

다리의 방향이 중간에 바뀌면 안되기 때문에, 다리의 방향은 가로 또는 세로가 될 수 밖에 없다. 방향이 가로인 다리는 다리의 양 끝이 가로 방향으로 섬과 인접해야 하고, 방향이 세로인 다리는 다리의 양 끝이 세로 방향으로 섬과 인접해야 한다.

섬 A와 B를 연결하는 다리가 중간에 섬 C와 인접한 바다를 지나가는 경우에 섬 C는 A, B와 연결되어있는 것이 아니다. 


나라의 정보가 주어졌을 때, 모든 섬을 연결하는 다리 길이의 최솟값을 구해보자.


## 입력

첫째 줄에 지도의 세로 크기 N과 가로 크기 M이 주어진다. 둘째 줄부터 N개의 줄에 지도의 정보가 주어진다. 각 줄은 M개의 수로 이루어져 있으며, 수는 0 또는 1이다. 0은 바다, 1은 땅을 의미한다.

1 ≤ N, M ≤ 10
3 ≤ N×M ≤ 100
2 ≤ 섬의 개수 ≤ 6

## 출력

모든 섬을 연결하는 다리 길이의 최솟값을 출력한다. 모든 섬을 연결하는 것이 불가능하면 -1을 출력한다.

## 해결방법

먼저 각 섬의 개수와 번호를 알아내야한다.

이때 모든점에 대해서 bfs를 하면서 인접한 만나는 모든 노드들은 하나의 섬이라고 생각할 수 있고,

각 점의 값을 섬의 번호로 바꾼다.

이미 방문한 노드들에 대해서는 continue를 하도록 하면 각 섬들의 번호와 섬의 개수를 알아낼 수 있게된다.

그후 모든 점에 대해서 상하좌우 직선으로 행렬의 범위 내 존재하면서, 현재의 섬의 값과 다른 값인 섬이 발견될 때까지, 바다부분을 일직선으로 탐색하면서 바다가 아니면서 다른 섬의 값을 만나게 되면 정지하도록 한다.

그리고 반복문이 끝나면 정지한 부분의 좌표가 행렬의 범위내 존재할 때 거리 값을 이용해 기존의 섬과 섬을 잇는 최단거리의 간선값을 업데이트해준다.

이때 조건에 다리의 길이는 2부터 연결할 수 있는경우로 판단하므로 이부분 또한 조건문에 추가한다.

(graph[a][b] = min(graph[a][b],dist)

이후 만든 그래프로 최소신장트리 알고리즘을 사용해 연결할 수 있는 가장 작은 총 다리길이를 구하면 된다.

## 복잡도

섬 번호 매기기 : 모든 좌표를 한번씩만 탐색하므로 o(nm)

모든 좌표에서 상하좌우로 뻗을 수 있는지 확인 -> 뻗을 수 있다면 max(m,n) 번 뻗어서 다음 섬이 있는지, 거리가 얼마나되는지 확인하므로  o(nm*max(m,n))

프림알고리즘: o(Elog v)이지만 lazy evaluation을 사용했으므로 o(Elog E), E = v^2-1이므로 지수를 앞으로 빼면 o(Elogv) 로 표현가능        

섬의 개수는 6개 이하이므로 무시할만한 수준

시간복잡도 : o(nm* max(n,m));
공간복잡도: o(nm)
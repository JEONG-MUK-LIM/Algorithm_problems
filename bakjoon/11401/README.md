# 문제: 11401(이항계수 3)

자연수 n과 정수 k가 주어졌을 때 이항 계수 
nCk를 1,000,000,007로 나눈 나머지를 구하는 프로그램을 작성하시오.

## 입력

첫째 줄에 
n과 k가 주어진다. (1 ≤ n ≤ 4,000,000, 0 ≤ k ≤ n)

## 출력


nCk를 1,000,000,007로 나눈 나머지를 출력한다.

## 해결방법

조합의 공식을 이용한다

N개중에 K개를 중복없이 뽑는 방법은 N * N-1 * N-2 *... / K! 이고

다른 식으로 나타내면 (순열을 이용) N! / K!* (N-K)! 이다

N! mod p = ((N(N-1))mod p)* N-2)mod p) .... 이고

N! mod p / (K!(N-K)!) mod p에서 모듈러 연산에서 나눗셈은 역원곱셈이다.

그러므로 N! mod p * (K!(N-K)! ^-1) mod p를 구해야 한다.

여기서 p가 소수라는 사실을 이용하는 방법이 있고, 소수라는 사실을 몰라도 이용할 수 있는 방법이 있다.

### p가 소수라는 사실을 이용할 경우 

페르마의 소정리를 이용하는 것인데

(a^(p-1)) % p = 1 이므로 a^(p-2) 는 a의 모듈러스 p에서의 역원이 된다.

참고 : (a * a^(p-2)) mod p = a ^(p-1) mod p

구현시 square and multiply 알고리즘을 사용한다. (빠르게 지수연산을 하는 알고리즘)

### 소수라는 사실을 모르는 경우 

확장 유클리드 알고리즘을 사용해야한다.

확장 유클리드 알고리즘을 자세히 모른다면 직접 찾아보도록 하고

계산 방법은 다음과 같다. 
<br/>
p는 모듈러스, a는 역원을 찾아야하는 값이다.

q는 몫, r은 나머지
```
q    x1  x2  r     t1  t2   t
q0   p   a   r0    0   1    t1-q*t2     x1,x2,r 과 t1,t2,t를 한칸씩 좌측으로 시프트
q1   a   r0  r1    1  t1-q*t2 ...
.
.
.
         1   0         a^-1  

즉 x2가 1(r이 0)이 될 때 t2값을 리턴하면 된다.
```
보통 확장 유클리드 방법이 페르마의 소정리 방법을 포함하므로 (소수가 아니어도 가능한 방법, 단 역원을 구하려는 값과 모듈러스가 서로소여야만 함)

## 복잡도

시간복잡도는 역원을 구할 때는 gcd를 구할 때와 동일하므로 o(log modulus)

팩토리얼을 구하는데 o(n) 이므로 o(n) + o(log modulus)가 됨

공간복잡도는 o(1)이 된다.
